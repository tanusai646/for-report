%情報工学実験2 テーマ3 実験レポート
%2024/2/8更新
\documentclass[dvipdfmx]{jsarticle}

\usepackage{listings, jlisting, color}
\usepackage[dvipdfmx]{graphicx}
\usepackage{pdfpages}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{multirow}
\usepackage{color}
\usepackage{ulem}
\usepackage{here}
\usepackage{wrapfig}


\newcommand{\Add}[1]{\textcolor{red}{#1}}
\newcommand{\Erase}[1]{\textcolor{red}{\sout{\textcolor{black}{#1}}}}
\newcommand{\ctext}[1]{\raise0.2ex\hbox{\textcircled{\scriptsize{#1}}}}

\lstset{
  basicstyle={\ttfamily},
  identifierstyle={\small},
  commentstyle={\smallitshape},
  keywordstyle={\small\bfseries},
  ndkeywordstyle={\small},
  stringstyle={\small\ttfamily},
  frame={tb},
  breaklines=true,
  columns=[l]{fullflexible},
  numbers=left,
  xrightmargin=0zw,
  xleftmargin=3zw,
  numberstyle={\scriptsize},
  stepnumber=1,
  numbersep=1zw,
  lineskip=-0.5ex
}

\makeatletter % プリアンブルで定義開始

% 表示文字列を"図"から"Figure”へ，"表"から"Table”へ
\renewcommand{\figurename}{図}
\renewcommand{\tablename}{表}

% 図，表番号を"<章番号>.<図番号>” ，"<章番号>.<表番号>” へ
\renewcommand{\thefigure}{\thesection-\arabic{figure}}
\renewcommand{\thetable}{\thesection-\arabic{table}}

% 章が進むごとに図番号をリセットする
\@addtoreset{figure}{section}
\@addtoreset{table}{section}

\makeatother % プリアンブルで定義終了

\begin{document}

\title{テーマ3 \\通信システムのシミュレーション}
\author{222C1021 今村優希}
\maketitle
\newpage

\section{目的}
今回の実験では、符号分割多元接続(CDMA)方式をシミュレーションシステムの一つであるMATLABおよびSimulinkを利用して解析を行う。
CDMAワイヤれる通信システムを作成し、CDMA方式の特性測定を行うことでCDMA方式の特徴や性質を理解することを目的にしている。

\section{背景}
以前までのワイヤレス通信システムでは時分割多元接続(TDMA)方式や、周波数分割多元接続方式(FDMA)が使用されていた。
現在は、CDMA方式が用いられており、それら2つの方式よりも単位周波数・時間あたりのユーザー数が多い。


\section{実験手順}
\subsection{手順1}
手順1ではBPSK変調を用いたディジタル無線通信システムノ性能評価を行う。

\subsubsection{実験方法}
入力信号の作成を行う。"Switch"に対して1と0に設定した"Constant"2つ上下に接続させる。
さらにランダムに入力させたいので"Uniform Random Number"を真ん中に接続させ入力信号の回路を完成させた。

次にBPSK変調を作成した。
先程作成した入力信号からの出力と1と0に設定した"Constant"2つを"Switch"に接続させて完成させた。

次に伝送路における雑音生成を作成した。
"Band-Limited White Noise"に"Gain"を接続させる。
雑音の生成は$N(0,1)$の標準正規分布のランダム信号を$avp$倍することで生成を行った。
具体的には、$avp=\tfrac{1}{\sqrt{2}}10^{-\frac{SNR}{20}}$を代入させ、SNRの値を変更させることでBER(Bit Error Rate)の観察を行った。
Gainからの出力及び、BRSK変調からの出力を"Add"合わせて雑音生成部分を完成させた。

BPSK復調に関しては、BPSK変調と同じ形である。

最後に入力信号と出力信号の正誤を確認しないといけないので"Error Rate Caluculation"に入力信号、出力信号をそれぞれ接続させ、
"Display"に出力を設定させて実験環境を整備した。

作成した回路は\ref*{fig:4-1}である。
\begin{figure}[H]
  \begin{center}
    \includegraphics*[scale=0.8]{graphic/4-1.png}
  \end{center}
  \caption[]{BPSK変調を観察する回路}
  \label{fig:4-1}
\end{figure}

この回路を送信データビットを10000ビットに設定を行ってから実行を行った。
"Gain"の$SNR$の値を変更させながら観察を行った。

\subsubsection{実験結果}
出力の結果を表\ref{tb:1}にまとめた。
$SNR$の値が大きくなるに連れBERが小さくなることが確認できた。
\begin{table}[H]
  \caption{図\ref*{fig:4-1}回路の実行結果}
  \centering
  \begin{tabular}{|c|c|}\hline
    $SNR$ & BER \\ \hline
    1 & 0.0589 \\ \hline
    2 & 0.0399 \\ \hline
    3 & 0.0255 \\ \hline
    4 & 0.0129 \\ \hline
    5 & 0.0063 \\ \hline
    6 & 0.0023 \\ \hline
    7 & 0.0009 \\ \hline
    8 & 0.0003 \\ \hline
    9 & 0.0001 \\ \hline
    10 & 0 \\ \hline
  \end{tabular}
  \label{tb:1}
\end{table}

\subsection{手順2}
手順2ではPN系列生成回路を作成し、パターン信号の観察を行う。

\subsubsection{実験方法}
まず"Delay"を5つ用意し、それぞれ一直線に接続させる。
一番最初の"Delay"の隣と最後の"Delay"からの出力を"XOR"に接続させ、そこからの出力を最初の"Delay"に繋げ実験環境の整備を行った。
そして各"Delay"の初期値は0,1,1,0,0で設定を行った。

各"Delay"からの出力を確認したいので"Display"を接続させた。
作成した回路は\ref*{fig:4-2}である。

\begin{figure}[H]
  \begin{center}
    \includegraphics*[]{graphic/4-2.png}
  \end{center}
  \caption{PN系列生成回路}
  \label{fig:4-2}
\end{figure}

終了時間を31に設定し、"Display"の出力を確認した。

\subsubsection{実験結果}
各"Display"の出力は以下の表\ref*{tb:4-2}のようになった。
この結果から31回目で初期値と同じ値が出力されていることが観察された。
PN系列では周期$T$でパターン信号を繰り返すことがわかっている。
$n$にはシフトレジスタの数が代入される。
\begin{align}
  T = 2^n - 1
\end{align}
今回、5つのシフトレジスタを使用したため、$n = 5$より、
\begin{align}
  T' &= 2^5 - 1\\
  T' &= 31
\end{align}
となり、31回で初期値と同じ値になることが分かる。
\begin{table}[H]
  \centering
  \caption{図\ref*{fig:4-2}の実行結果}
  \begin{tabular}{|c|ccccc|}\hline
    & $D_0$ & $D_2$ & $D_3$ & $D_4$ & $D_5$ \\ \hline
    0 & 0 & 1 & 1 & 0 & 0 \\ \hline
    1 & 1 & 0 & 1 & 1 & 0 \\ \hline
    2 & 0 & 1 & 0 & 1 & 1 \\ \hline
    3 & 0 & 0 & 1 & 0 & 1 \\ \hline
    4 & 1 & 0 & 0 & 1 & 0 \\ \hline
    5 & 0 & 1 & 0 & 0 & 1 \\ \hline
    6 & 0 & 0 & 1 & 0 & 0 \\ \hline
    7 & 0 & 0 & 0 & 1 & 0 \\ \hline
    8 & 0 & 0 & 0 & 0 & 1 \\ \hline
    9 & 1 & 0 & 0 & 0 & 0 \\ \hline
    10 & 0 & 1 & 0 & 0 & 0 \\ \hline
    11 & 1 & 0 & 1 & 0 & 0 \\ \hline
    12 & 0 & 1 & 0 & 1 & 0 \\ \hline
    13 & 1 & 0 & 1 & 0 & 1 \\ \hline
    14 & 1 & 1 & 0 & 1 & 0 \\ \hline
    15 & 1 & 1 & 1 & 0 & 1 \\ \hline
    16 & 0 & 1 & 1 & 1 & 0 \\ \hline
    17 & 1 & 0 & 1 & 1 & 1 \\ \hline
    18 & 1 & 1 & 0 & 1 & 1 \\ \hline
    19 & 0 & 1 & 1 & 0 & 1 \\ \hline
    20 & 0 & 0 & 1 & 1 & 0 \\ \hline
    21 & 0 & 0 & 0 & 1 & 1 \\ \hline
    22 & 1 & 0 & 0 & 0 & 1 \\ \hline
    23 & 1 & 1 & 0 & 0 & 0 \\ \hline
    24 & 1 & 1 & 1 & 0 & 0 \\ \hline
    25 & 1 & 1 & 1 & 1 & 0 \\ \hline
    26 & 1 & 1 & 1 & 1 & 1 \\ \hline
    27 & 0 & 1 & 1 & 1 & 1 \\ \hline
    28 & 0 & 0 & 1 & 1 & 1 \\ \hline
    29 & 1 & 0 & 0 & 1 & 1 \\ \hline
    30 & 1 & 1 & 0 & 0 & 1 \\ \hline
    31 & 0 & 1 & 1 & 0 & 0 \\ \hline
  \end{tabular}
  \label{tb:4-2}
\end{table}

\subsection{手順3}
手順3ではCDMAシステムにおける各信号の時間は朝と周波数スペクトルの考察を行う。

\subsubsection{実験方法}
作成した回路はの図\ref*{fig:4-3}である。

\begin{figure}[H]
  \begin{center}
    \includegraphics*[]{graphic/4-3.png}
  \end{center}
  \caption{PN系列生成回路}
  \label{fig:4-3}
\end{figure}

この回路を用いて実行結果の確認を行った。

\subsubsection{実験結果}
信号1における"Spectrum Analyzer"の出力は図\ref*{fig:4-4}であり、これは送信したい信号である。
そして、信号2における出力がCDMAにおける符号に対応しており、PN系列を使用している。
PN系列の信号を図\ref*{fig:4-5}で示している。
送信信号とPN系列をかけたものが図\ref*{fig:4-6}である。
この信号を送信し、受信側で解析することで信号の送受信を実現している。
\begin{figure}[H]
  \begin{center}
    \includegraphics[scale=0.7]{graphic/4-4.png}
  \end{center}
  \caption{送信したい信号}
  \label{fig:4-4}
\end{figure}

\begin{figure}[H]
  \begin{center}
    \includegraphics[scale=0.45]{graphic/4-5.png}
  \end{center}
  \caption{PN系列符号}
  \label{fig:4-5}
\end{figure}

\begin{figure}[H]
  \begin{center}
    \includegraphics[scale=0.65]{graphic/4-6.png}
  \end{center}
  \caption{送信する信号}
  \label{fig:4-6}
\end{figure}

その後、送信された信号を受信する際に、同じ符号をその信号にかける。
その信号の出力を図\ref*{fig:4-7}である。
最後にBPSK復調を行ったあとの信号が図\ref*{fig:4-8}である。

\begin{figure}[H]
  \begin{center}
    \includegraphics[scale=0.4]{graphic/4-7.png}
  \end{center}
  \caption{受信した信号}
  \label{fig:4-7}
\end{figure}

\begin{figure}[H]
  \begin{center}
    \includegraphics[scale=0.7]{graphic/4-8.png}
  \end{center}
  \caption{復調後の信号}
  \label{fig:4-8}
\end{figure}

図\ref*{fig:4-4}と図\ref*{fig:4-8}の出力がほとんど同じであることから、PN系列をかけあわせて送信したとしても、PN系列を再びかけることでもとの信号を入手することができると分かった。


\section{課題の答え}
\subsection{課題1}
ユーザー1が送りたい信号を$x_1$、符号を$P_1(t)$とし、ユーザー2はそれぞれ$x_2$、$P_2(t)$とおく。
送信する際は信号と符号をかけあわせて送り、そのような信号が混在している。

したがって、受信側が受け取る信号は$y = x_1 P_1(t) + x_2 P_2(t)$となる。
ほしい信号を受け取るために符号をかけあわせると、$y' = x_1 P_1^2(t) + x_2 P_1(t) P_2(t)$となる。
ここで$P_1^2(t) = 1$、$P_1(t) P_2(t) = 0$と$P_n(t)$を設定しているため、
$y' = x_1$が導出でき、CDMA変調された信号は復調することができる。

\subsection{課題2}
Aを振幅とし、変数$x = A + n_I$に対して、$x$の確率密度関数は
\begin{align}
  p(x) = \dfrac{1}{\sqrt{2\pi}\sigma}exp(-\dfrac{(x-A)^2}{2\sigma^2})
\end{align}
と表される正規分布である。
このとき、ビットが誤る確率Pは$x \leq 0$の範囲より、
\begin{align}
  BER &= \dfrac{1}{\sqrt{2\pi}\sigma} \int_{-\infty}^{0 } exp(-\dfrac{(x-A)^2}{2\sigma^2}) \,dx \\
  &= \dfrac{1}{\sqrt{2\pi}\sigma} \int_{-\infty}^{-A } exp(-\dfrac{(x'^2)}{2\sigma^2}) \,dx'     (x'=x-A)\\
  &= \dfrac{1}{\sqrt{2\pi}\sigma} \int_{A}^{\infty} exp(-\dfrac{(x'^2)}{2\sigma^2}) \,dx'\\
  &= \dfrac{1}{2} erfc(\dfrac{A}{\sqrt{2}\sigma})
\end{align}
ここより、振幅を変更させることで
\begin{align}
  BER = \dfrac{1}{2}erfc(10^\frac{SNR}{20})
\end{align}
が導き出される。


\begin{thebibliography}{9}
  \bibitem{guide} 九州工業大学. "実験手順書". 九州工業大学情報工学部moodle. https://ict-i.el.kyutech.ac.jp/mod/folder/view.php?id=50976. (2023/12/4)
  \bibitem{} 唐沢好男. "熱雑音下のビット誤り率 ディジタル変調方式に対する BER推定の基本"
  \bibitem{} マイクロニクス株式会社. "いまさら聞けないスペクトラムアナライザの基礎（１）". https://micronix-jp.com/note/application/fundamentals\_of\_speana\_1.html. (2023/12/4)
\end{thebibliography}

\end{document}